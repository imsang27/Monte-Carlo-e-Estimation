# 자연상수 e 추정 프로그램

랜덤 숫자 시뮬레이션을 통해 자연상수 e를 추정하는 Python 프로그램입니다.

## 📖 알고리즘 소개

이 프로그램은 다음과 같은 통계적 성질을 이용합니다:

**0과 1 사이의 랜덤한 숫자들을 계속 더해 1을 초과하는데 필요한 숫자의 개수의 기댓값은 자연상수 e(≈2.71828...)와 같습니다.**

```
E[N] = e
```
여기서 N은 랜덤 숫자를 더해서 1을 초과하기까지 필요한 숫자의 개수입니다.

### 동작 방식

1. 0과 1 사이의 랜덤한 숫자를 계속 생성하여 더합니다
2. 합이 1을 초과하면 그때까지 사용한 숫자의 개수를 기록합니다
3. 위 과정을 여러 번 반복하여 평균 개수를 계산합니다
4. 이 평균값이 자연상수 e에 근사합니다

## ✨ 주요 기능

- 🚀 **메모리 최적화**: 대량의 라운드를 실행해도 메모리 문제 없음
- 📊 **실시간 진행률 표시**: 실행 중 진행 상황을 시각적으로 확인 가능
- ⏱️ **실행 시간 표시**: 경과 시간 및 예상 남은 시간(ETA) 실시간 표시
- 🎯 **고정밀도 계산**: Decimal을 사용하여 소수점 60자리까지 정확한 계산
- 📈 **상세한 결과 출력**: 절대 오차 및 상대 오차까지 표시

## 🛠️ 설치 요구사항

- Python 3.6 이상
- 표준 라이브러리만 사용 (추가 패키지 설치 불필요)

## 🚀 사용 방법

```bash
python estimate_e_from_random_sum.py
```

실행하면 다음과 같이 입력을 요청합니다:

```
몇 번 실행하시겠습니까: 1000000
```

### 출력 예시

```
(10,000/1,000,000회 완료)
진행률: [████                                ] 1.0% | 경과 시간: 2.3초, 예상 남은 시간: 3분 47.7초
(20,000/1,000,000회 완료)
진행률: [██████                              ] 2.0% | 경과 시간: 4.5초, 예상 남은 시간: 3분 38.3초
...
(1,000,000/1,000,000회 완료)
진행률: [████████████████████████████████████] 100.0% | 경과 시간: 3분 42.1초 예상 남은 시간: 0.0초

총 실행 시간: 3분 42.1초
총 1,000,000회 실행했으며, 평균 뽑은 횟수는 2.717 986 000 000 000 000 000 000 000 000 000 000 000 000 000 000 00회입니다.
자연상수 e = 2.718 281 828 459 045 235 360 287 471 352 662 497 757 247 093 699 95
절대 오차: 0.000 295 828 459 045 235 360 287 471 352 662 497 757 247 093 699 95
상대 오차: 0.01088%
```

## 📝 함수 설명

### `generate_until_sum_exceeds_one()`
- 0과 1 사이의 랜덤 숫롸를 더해 1을 초과할 때까지 생성
- 반환값: (numbers, total, count) - 사용된 숫자 리스트, 총합, 개수

### `calculate_average_count(n, show_progress=True)`
- n번의 라운드를 실행하고 평균 개수 계산
- 메모리 최적화: 결과를 한 번에 저장하지 않고 즉시 합산
- `show_progress`: 진행률 표시 여부 (기본값: True)

### `format_decimal_with_spaces(d, precision=50)`
- Decimal 값을 읽기 쉽게 소수부를 3자리 단위로 공백을 넣어 포맷팅

### `format_time(seconds)`
- 초 단위 시간을 읽기 쉬운 형식으로 변환
- 60초 미만: "XX.X초"
- 1시간 미만: "XX분 XX.X초"
- 1시간 이상: "XX시간 XX분 XX.X초"

## ⚙️ 성능

- **메모리 사용량**: O(1) - 라운드 수와 무관하게 일정한 메모리 사용
- **실행 시간**: O(n) - 라운드 수에 비례하여 선형 증가
- **정확도**: 라운드 수가 많을수록 더 정확한 e 값에 근접

## 🔧 최적화 내용

### 메모리 최적화
기존에는 각 라운드의 모든 숫자를 메모리에 저장하여 대량 실행 시 MemoryError가 발생했습니다. 이를 해결하기 위해:
- 불필요한 데이터(numbers, sum) 저장 제거
- count 값만 즉시 합산하여 메모리 사용량 최소화

### 진행률 표시
대량의 라운드를 실행할 때 진행 상황을 확인할 수 있도록:
- 실시간 진행률 바 표시
- 완료 횟수 및 퍼센트 표시
- 경과 시간 및 예상 남은 시간(ETA) 표시
- ANSI escape code를 사용한 깔끔한 두 줄 형식
- 완료 후 총 실행 시간 표시

## 📚 수학적 배경

이 알고리즘은 다음과 같은 확률 이론에 기반합니다:

랜덤 숫자 U₁, U₂, ..., Uₙ이 각각 [0,1] 구간에서 균등 분포를 따를 때,
```
P(U₁ + U₂ + ... + Uₙ ≤ 1) = 1/n!
```

따라서 합이 1을 초과하기까지 필요한 개수 N의 기댓값은:
```
E[N] = Σ(n=1 to ∞) P(N > n) = Σ(n=0 to ∞) 1/n! = e
```

## 📄 라이선스

이 프로젝트는 MIT 라이선스를 따릅니다.

## 🤝 기여

버그 리포트나 기능 제안은 [Issue](https://github.com/imsang27/Monte-Carlo-e-Estimation/issues)로 등록해주세요!
